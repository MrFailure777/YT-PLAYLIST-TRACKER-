{% extends 'base.html' %}
{% block content %}
<section class="dashboard">
  <!-- Top row -->
  <div class="controls">
    <!-- Add Playlist Form -->
    <form class="add-form glass" action="{{ url_for('add_playlist') }}" method="post">
      <h3 class="form-title">Add Playlist</h3>
      <input name="title" placeholder="Playlist title (optional)">
      <input name="url" placeholder="Playlist URL" required>
      <input name="total_videos" placeholder="Total videos (number)" type="number" min="0">
      <button class="btn">Add Playlist</button>
    </form>

    <!-- Total Progress -->
    <div class="total-progress glass">
      <h3>Total Progress</h3>
      <div class="overall-bar">
        <div class="fill" style="width: {{ total_progress }}%"></div>
      </div>
      <div class="meta">
        {{ total_completed }} / {{ total_videos }} videos â€” <strong>{{ total_progress }}%</strong>
      </div>
    </div>
  </div>

 <!-- Playlist Cards -->
<div class="cards">
  {% if playlists %}
  {% for p in playlists %}
  <div class="card glass playlist-card" id="pl-{{ p.id }}">
    <!-- Card Header -->
    <div class="card-head flex-row">
      <h2 class="title">{{ p.title }}</h2>
    </div>

    <!-- Progress Info -->
    <div class="progress-section">
      <div class="progress-text">
        <span>{{ p.completed_videos }} / {{ p.total_videos }} videos</span>
        <span class="percent">{{ p.progress_percent }}%</span>
      </div>
      <div class="progress-bar big">
        <div class="bar-fill 
          {% if p.progress_percent < 40 %}low
          {% elif p.progress_percent < 70 %}mid
          {% else %}high{% endif %}" 
          style="width: {{ p.progress_percent }}%">
        </div>
      </div>
    </div>

    <!-- Controls in same row -->
    <div class="card-controls flex-row">
      <div class="btn-group">
        <button class="btn tiny inc" data-id="{{ p.id }}">+1</button>
        <button class="btn tiny dec" data-id="{{ p.id }}">-1</button>
      </div>
      <div class="btn-group">
        <a href="{{ p.url }}" target="_blank" class="btn small">Open</a>
        <button class="btn small danger remove-btn" data-id="{{ p.id }}">Remove</button>
      </div>
      <span class="hint">ID: {{ p.id }}</span>
    </div>
  </div>
  {% endfor %}
  {% else %}
  <p class="muted no-playlists">No playlists yet. Add one from the form above.</p>
  {% endif %}
</div>

</section>
{% endblock %}
